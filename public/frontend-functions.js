function makeDataOverviewChartjs(id,data){var ctx=document.getElementById(id).getContext('2d');labels=['Historial','Low emissions (RCP 4.5)','High emissions (RCP 8.5)'];colors=['#18bc9c','#f39c12','#e74c3c'];var datasets=data.map((v,i)=>{let dataset={label:labels[i],borderColor:colors[i],showLine:!0,radius:1,hitRadius:5,data:v.map(vv=>({x:vv.year,y:vv.value}))};return dataset});new Chart(ctx, {type:'scatter',data:{datasets:datasets},options:{maintainAspectRatio:!1,resizeDelay:300,plugins:{legend:{onClick:null,labels:{boxHeight:2}}},animation:{x:{duration:1000,from:250},y:{duration:1000,from:150}},scales:{x:{type:'linear',min:1990,max:2050,ticks:{callback:function(value,index,values){if(value%10!=0)return'';return value}}}},elements:{line:{tension:0.2}}}})}function fetchAddressSearchResults(host,key,query,callback){fetch(`${host}/address/indexes/addresses/search`,{method:'POST',headers:{'Content-Type':'application/json','Authorization':`Bearer ${key}`},body:JSON.stringify({q:query,limit:10})}).then(response=>response.json()).then(data=>{callback(data.hits.map(hit=>({id:hit.id,name:joinAddressColumns(hit)})))}).catch(error=>{console.error('Error fetching results from Meilisearch:',error);callback()})}function joinAddressColumns(item){return ['NUMBER_FIRST','STREET_NAME','LOCALITY_NAME','POSTCODE'].map(e=>item[e]).join(' ')}function selectizeAddress(id){let idData=document.querySelector(id).dataset;let host=idData.apiUrl;let key=idData.apiKey;$(id).selectize({valueField:'id',labelField:'name',searchField:'name',maxOptions:10,loadThrottle:300,maxItems:1,closeAfterSelect:!0,load:function(query,callback){if(!query.length)return callback();this.clearOptions();fetchAddressSearchResults(host,key,query,callback)},onDelete:function(){this.clearOptions()},sortField:null,score:function(search){var score=this.getScoreFunction(search);return item=>1+score(item)}})}
